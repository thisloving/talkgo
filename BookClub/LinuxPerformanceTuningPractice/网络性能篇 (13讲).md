## 网络模型

+ 传输层在应用程序数据前面增加了 TCP 头；
+ 网络层在 TCP 数据包前增加了 IP 头；
+ 网络接口层，又在 IP 数据包前后分别增加了帧头和帧尾。

## 性能指标

+ 带宽，表示链路的最大传输速率，单位通常为 b/s （比特 / 秒）。
+ 吞吐量，表示单位时间内成功传输的数据量，单位通常为 b/s（比特 / 秒）或者 B/s（字节 / 秒）。吞吐量受带宽限制，而吞吐量 / 带宽，也就是该网络的使用率。
+ 延时，表示从网络请求发出后，一直到收到远端响应，所需要的时间延迟。在不同场景中，这一指标可能会有不同含义。比如，它可以表示，建立连接需要的时间（比如 TCP 握手延时），或一个数据包往返所需的时间（比如 RTT）。
+ PPS，是 Packet Per Second（包 / 秒）的缩写，表示以网络包为单位的传输速率。PPS 通常用来评估网络的转发能力，比如硬件交换机，通常可以达到线性转发（即 PPS 可以达到或者接近理论最大值）。而基于 Linux 服务器的转发，则容易受网络包大小的影响。

### C10K

select、poll、epoll

### C1000K

C1000K 的解决方法，本质上还是构建在 epoll 的非阻塞 I/O 模型上。只不过，除了 I/O 模型之外，还需要从应用程序到 Linux 内核、再到 CPU、内存和网络等各个层次的深度优化，特别是需要借助硬件，来卸载那些原来通过软件处理的大量功能。

### C10M

+ 第一种机制，DPDK，是用户态网络的标准。它跳过内核协议栈，直接由用户态进程通过轮询的方式，来处理网络接收。

+ 第二种机制，XDP（eXpress Data Path），则是 Linux 内核提供的一种高性能网络数据路径。它允许网络包，在进入内核协议栈之前，就进行处理，也可以带来更高的性能。

## tcpdump

tcpdump -nn udp port 80 or host 47.90.29.3-w ping.pcap

## DDOS

+ netstat -n -p | grep SYN_REC

+ netstat -n -p | grep SYN_REC | wc -l

+ iptables -I INPUT -s 192.168.0.2 -p tcp -j REJECT

## NAT 原理

NAT 的主要目的，是实现地址转换。

+ 静态 NAT，即内网 IP 与公网 IP 是一对一的永久映射关系；

+ 动态 NAT，即内网 IP 从公网 IP 池中，动态选择一个进行映射；

+ 网络地址端口转换 NAPT（Network Address and Port Translation），即把内网 IP 映射到公网 IP 的不同端口上，让多个内网 IP 可以共享同一个公网 IP 地址。

## 性能工具

+ ifconfig、ip 配置和查看网络接口
+ ss 查看网络连接数
+ tcpdump 网络抓包工具
+ iptables 配置和管理防火墙及NAT规则
+ perf 剖析内核协议栈的性能
+ systemtap、bcc 动态追踪内核协议栈的行为